<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>index</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><link rel="stylesheet" href="https://unpkg.com/bamboo.css/dist/dark.min.css">
<link rel="stylesheet" href="./src/css/styles.css">
<!--<script src="./src/js/syntaxHighlight.js" defer></script>--></p>
<h1
id="fullstack-development---client-and-server-communication-with-abstraction">Fullstack
Development - Client and Server Communication with Abstraction</h1>
<p>George D. Crochiere</p>
<p>COMM-429 Front End Development</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#intro">Introduction</a></li>
<li><a href="#example">The Example &amp; Stack</a>
<ul>
<li><a href="#example-prereq">Prerequisites</a></li>
</ul></li>
<li><a href="#structure">Communication Structure</a>
<ul>
<li><a href="#structure-client">Client</a></li>
<li><a href="#structure-server">Server</a></li>
<li><a href="#structure-diagram">Diagram</a></li>
</ul></li>
<li><a href="#implement">Implementation Overview</a></li>
<li><a href="#conclude">Conclusion</a></li>
</ul>
<hr />
<p><a name="intro"></a></p>
<h2 id="introduction">Introduction</h2>
<p>In the development of a larger web project, there is typically the
need to update and recieve data between the website, and a database of
some form. While it is possible to get data utilizing the <a
href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">fetch</a>
command with JavaScript and data APIs, the only way to alter data and
store it permanently is with a database.</p>
<p>With this is mind, in the development of a project I am working on at
my university, the developement of the Honors Program website, I’ve
needed to implement more methods to the program to access data from the
associated database, needing to build off the pre-existing system. Given
how the system has been abstracted to allow for more organized data
structures, this article was designed to give an overview on how you can
possible structure your client-server communication.</p>
<hr />
<p><a name="example"></a></p>
<h2 id="the-example-stack">The Example &amp; Stack</h2>
<p>To recap, this project is a closed-source project that already
exists, focused on tracking submitted data for my university’s honors
program, which include program requirements such as service hours. This
project was made with the following stack:</p>
<ul>
<li><a href="https://nodejs.org/en">NodeJS</a></li>
<li><a href="https://react.dev/">ReactJS</a>
<ul>
<li>HTML</li>
<li>CSS</li>
<li>JavaScript
<ul>
<li><a href="https://mui.com/material-ui/">Material MUI</a></li>
</ul></li>
</ul></li>
<li><a href="https://expressjs.com/">ExpressJS</a>
<ul>
<li>JavaScript</li>
</ul></li>
<li><a href="https://axios-http.com/docs/intro">Axios</a></li>
<li><a href="https://www.mysql.com/">MySQL</a></li>
</ul>
<p>The project itself is primarly broken into three directoried:</p>
<ul>
<li><code>client</code> - Contains files relavent to maintaining the
client side of the website</li>
<li><code>server</code> - Contains files associated with the server and
interactions with the MySQL database</li>
<li><code>shared</code> - A directory associated with schematic files
utilized by both the client and the server.</li>
</ul>
<hr />
<p><a name="prereq"></a></p>
<h3 id="prerequisites">Prerequisites</h3>
<p>Note that for this project to work, you need to have a client-server
based website that is based off of ReactJS and ExpressJS. <strong>This
article will not cover how to start a project from scratch; it will
assume you have some client and server at least functional.</strong></p>
<p>For some examples on how to start a project between a ReactJS client
and an ExpressJS server, you can refer to <a
href="https://dev.to/techcheck/creating-a-react-node-and-express-app-1ieg">this
DEV Community article</a> or <a
href="https://www.freecodecamp.org/news/create-a-react-frontend-a-node-express-backend-and-connect-them-together-c5798926047c/">this
freeCodeCamp article</a> for some examples.</p>
<p>To make it easier, you should also have some background with how
general requests and responces work, as mentioned in the following
secion on the structure of the program. This will make it easier to
troubleshoot, as this post will not include all code to make the program
run, just the code associated with requests and responces.</p>
<hr />
<p><a name="structure"></a></p>
<h2 id="communication-structure">Communication Structure</h2>
<p>When you are making your first ReactJS and ExpressJS project, you
might have an example of creating requests and responses between the
client and server. The freeCodeCamp tutorial above gives us a server
that has a main router broken into the main server file and the router
controller, and the client page file that utilizes fetch to get
data.</p>
<h5 id="server-app.js---freecodecamp.org">server-app.js -
freeCodeCamp.org</h5>
<div class="sourceCode" id="cb1"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> testAPIRouter <span class="op">=</span> <span class="pp">require</span>(<span class="st">&quot;./routes/testAPI&quot;</span>)<span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>app<span class="op">.</span><span class="fu">use</span>(<span class="st">&quot;/testAPI&quot;</span><span class="op">,</span> testAPIRouter)<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span></code></pre></div>
<h5 id="server-test-router.js---freecodecamp.org">server-test-router.js
- freeCodeCamp.org</h5>
<div class="sourceCode" id="cb2"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> express <span class="op">=</span> <span class="pp">require</span>(“express”)<span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> router <span class="op">=</span> express<span class="op">.</span><span class="fu">Router</span>()<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>router<span class="op">.</span><span class="fu">get</span>(“<span class="op">/</span>”<span class="op">,</span> <span class="kw">function</span>(req<span class="op">,</span> res<span class="op">,</span> next) {</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    res<span class="op">.</span><span class="fu">send</span>(“API is working properly”)<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> router<span class="op">;</span></span></code></pre></div>
<h5 id="client-app.js---freecodecamp.org">client-app.js -
freeCodeCamp.org</h5>
<div class="sourceCode" id="cb3"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">constructor</span>(props) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">super</span>(props)<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">state</span> <span class="op">=</span> { <span class="dt">apiResponse</span><span class="op">:</span> <span class="st">&quot;&quot;</span> }<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">callAPI</span>() {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fetch</span>(<span class="st">&quot;http://localhost:9000/testAPI&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">then</span>(res <span class="kw">=&gt;</span> res<span class="op">.</span><span class="fu">text</span>())</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">then</span>(res <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">setState</span>({ <span class="dt">apiResponse</span><span class="op">:</span> res }))<span class="op">;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">componentWillMount</span>() {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">callAPI</span>()<span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>p className<span class="op">=</span><span class="st">&quot;App-intro&quot;</span><span class="op">&gt;;</span>{<span class="kw">this</span><span class="op">.</span><span class="at">state</span><span class="op">.</span><span class="at">apiResponse</span>}<span class="op">&lt;/</span>p<span class="op">&gt;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span></code></pre></div>
<p>While this server setup is a starting point, we need to expand upon
both setups to allow for more abstraction and better control of each
operation.</p>
<blockquote>
<p>For more information on how requests (GET and POST) and responses
work in web communication, you can refer to <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages">this
article from the MDN Web Docs</a></p>
</blockquote>
<hr />
<p><a name="structure-client"></a></p>
<h3 id="client">Client</h3>
<p>The client is the part of the whole projects that sets up the request
in the first place, regardless of the type that is initialized. To allow
for the website client to be able to control how its calls are made, a
file can be made for each webpage that contains the different API
functions. This is known as a controller. The controller doesn’t push
the entire function; it only takes the inputs that are passed into it
from the webpage, and moves into the generalized website
<code>apiAdapter</code>, which when given the list of files it can pull
functions from, then sends the request message to the server.</p>
<p><a name="structure-server"></a></p>
<h3 id="server">Server</h3>
<p>When a request is picked up by the server, the ExpressJS server gets
the URL that is the request, as all requests and the data associated
with them are identified by a unique URL, and uses the first argument to
identify which router to utilize. This file also takes the input
arguments and starts passing the data through the system into the next
stages of the server. The router then identifies which code to run, with
this code being the model that represents the data. It is in this model
file that the data is actually processed and it interacts with the
database.</p>
<p>In general, as each of these functions are making a request to a
function, followed by a form of response, this responce is then
constantly passed back up through the chain, and forms a responce that
is sent via a URL. This URL responce goes back to the client, where this
process continues to return data to be added to the server.</p>
<p><a name="structure-diagram"></a></p>
<h3 id="diagram">Diagram</h3>
<p>Below is a diagram that outlines the above process in a visual
form:</p>
<figure>
<img src="./src/images/Diagram-COMM429-Final.png"
alt="Diagram of Client and Server interactions." />
<figcaption aria-hidden="true">Diagram of Client and Server
interactions.</figcaption>
</figure>
<p>The communication that occurs between the client and the server, at
least in the form of this project, relies on a singular instance of the
Axios API Adapter, though this can be replaced with the use of the <a
href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">fetch
API</a>.</p>
<hr />
<p><a name="implement"></a></p>
<h2 id="implementation-overview">Implementation Overview</h2>
<blockquote>
<p><strong>THIS CODE IS NOT ACCURATE TO EVERY PROJECT!</strong> Given
how this project is closed source, the code provided on this blog post
has been altered. You will likely have to modify some code to work best
with your database, the data you are passing from the client to the
server, and more.</p>
</blockquote>
<p>To implement this entire process, we can start on the server-end,
where similar to the freeCodeCamp.org example.</p>
<blockquote>
<p><strong>NOTE:</strong> This project does not show the exact folder
pathing used in this project. Whatever file system you implement only
modifies import-related statements.</p>
</blockquote>
<p>Let’s start with the server. We’re going to assume that the database
is fully set up as well, as this setup is very much determined by what
your website is for. The model is the section of code that, given input
data from a request, actually runs the process in the database to obtain
or modify the data stored.</p>
<blockquote>
<p>This model system utilizes a specific database helper and models to
get information relating to the database. This is a connection that
creates a single instance of the database utilizing the following node
packages: <code>mysql2</code>, <code>express-session</code>, and
<code>express-mysql-session</code>. The database is initialized to
ensure that a single connection exists at one time to reduce resources
used on the server. Database initialization is done on server startup,
and each request simply uses the call.</p>
</blockquote>
<h5 id="database_helper.js">database_helper.js</h5>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> initializeDatabase <span class="op">=</span> (config<span class="op">,</span> callback) <span class="kw">=&gt;</span> {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (_connection) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">&#39;database is already initialized&#39;</span>)<span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// initialize mysql connection</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  _connection <span class="op">=</span> mysql<span class="op">.</span><span class="fu">createPool</span>(config)<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// initialize session store</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  _sessionStore <span class="op">=</span> <span class="kw">new</span> <span class="fu">MySqlStoreClass</span>({}<span class="op">,</span> _connection)<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`database initialized -- connected to </span><span class="sc">${</span>config<span class="op">.</span><span class="at">host</span><span class="sc">}</span><span class="vs">:</span><span class="sc">${</span>config<span class="op">.</span><span class="at">port</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">callback</span>()<span class="op">;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> getConnectionPool <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  assert<span class="op">.</span><span class="fu">ok</span>(_connection<span class="op">,</span> <span class="st">&#39;database has not been initialized&#39;</span>)<span class="op">;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> _connection<span class="op">;</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<h5
id="test_model_function.js---located-in-the-directory-srcmodelstesting">test_model_function.js
- Located in the directory ‘src/models/testing’</h5>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> databaseHelper <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;database_helper&#39;</span>)<span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    PayloadModel<span class="op">,</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;payload_model&#39;</span>)<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> someDatabaseModelFunction <span class="op">=</span> <span class="kw">async</span> (data) <span class="kw">=&gt;</span> {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Some processing here</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> query <span class="op">=</span> <span class="st">&#39;SELECT * FROM ... WHERE a = ? ...&#39;</span> <span class="co">// Enter your query</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> params <span class="op">=</span> [aParam]<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [data] <span class="op">=</span> <span class="cf">await</span> databaseHelper<span class="op">.</span><span class="fu">getConnectionPool</span>()<span class="op">.</span><span class="fu">query</span>(query<span class="op">,</span> params)<span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="fu">PayloadModel</span>(data)<span class="op">;</span> <span class="co">// PayloadModel is defined as a object able to hold data,</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="co">// stored in the variable &quot;data&quot;.</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> someDatabaseModelFunction<span class="op">;</span></span></code></pre></div>
<p>Once we have out model’s function, we can now make this model
accessible to the server’s controller via a process of pathing the
exports into a singular index.js file. For this example, we’ll path this
into a testing model group, with these model groups being pathed into an
overall model pattern. This nesting process allows us to categorize
model functions based on their overall functionality, and to further
make them all accessible from a single import.</p>
<h5 id="index.js---located-in-the-directory-srcmodelstesting">index.js -
Located in the directory ‘src/models/testing’</h5>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> someDatabaseModelFunction <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;./test_model_function.js&#39;</span>)<span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    someDatabaseModelFunction<span class="op">,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h5 id="index.js---located-in-the-directory-srcmodels">index.js -
Located in the directory ‘src/models’</h5>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> testingModel <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;./testing&#39;</span>)<span class="op">;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    testingModel<span class="op">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This makes the <code>someDatabaseModelFunction</code> database
accessor avaliable in the overall models import statement, but we need
to now incorporate the controller for the server. This controller will
need to call the model that was just made, but is the functionality that
is called when the request is taken.</p>
<hr />
<p>With this all in mind, let’s start by creating the specific
controller for the previously created model.</p>
<h5
id="somedatabasemodelfunction.controller.js---located-in-the-directory-srctestingcontroller">someDatabaseModelFunction.controller.js
- Located in the directory ‘src/testing/controller’</h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { testingModel } <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;../../models&#39;</span>)<span class="op">;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> someDatabaseModelFunction <span class="op">=</span> <span class="kw">async</span> (request) <span class="kw">=&gt;</span> {</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Pull data from the request if needed, for example, session data from the header.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="co">// Some input data, from above statement</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> model <span class="op">=</span> <span class="cf">await</span> testingModel<span class="op">.</span><span class="fu">someDatabaseModelFunction</span>(data)<span class="op">;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> responce <span class="op">=</span> {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">data</span><span class="op">:</span> model<span class="op">.</span><span class="at">data</span><span class="op">,</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">header</span><span class="op">:</span> {</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Add other header data, such as success variable, etc.</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            <span class="dt">status</span><span class="op">:</span> <span class="dv">0</span> <span class="co">// Success</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> response<span class="op">;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> someDatabaseModelFunction<span class="op">;</span></span></code></pre></div>
<p>We can now import this specific controller in the “testing” router
into it’s index file. This needs to be done by first getting all
controllers into a single file for a list of all possible controllers,
which can then be implemented into the router.</p>
<h5
id="index.js---located-in-the-directory-srctestingcontroller---concatenates-controllers">index.js
- Located in the directory ‘src/testing/controller’ - Concatenates
controllers</h5>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> someDatabaseModelFunction <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;./someDatabaseModelFunction.controller&#39;</span>)<span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> {</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    someDatabaseModelFunction<span class="op">,</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h5
id="index.js---the-router-for-all-testing-api-server-calls-located-in-the-directory-srctesting">index.js
- The router for all ‘testing’ API server calls, located in the
directory ‘src/testing’</h5>
<div class="sourceCode" id="cb10"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> express <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;express&#39;</span>)<span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> controller <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;./controller&#39;</span>)<span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> router <span class="op">=</span> express<span class="op">.</span><span class="fu">Router</span>()<span class="op">;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Now create the associated get/posts requests. </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">// For the purposes of this, our function will be a post request.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">// The data will be accessed at the URL (with port 3001):</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">// localhost:3001/testing/testingPost</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>router<span class="op">.</span><span class="fu">post</span>(<span class="st">&#39;/testingPost&#39;</span><span class="op">,</span> <span class="kw">async</span> (req<span class="op">,</span> res) <span class="kw">=&gt;</span> {</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> request <span class="op">=</span> {</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">header</span><span class="op">:</span> <span class="co">// Create request data with data from req</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                <span class="co">// this &#39;req&#39; variable is what is sent over the internet.</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> response <span class="op">=</span> <span class="cf">await</span> controller<span class="op">.</span><span class="fu">someDatabaseModelFunction</span>(request)<span class="op">;</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res<span class="op">.</span><span class="fu">send</span>(response)<span class="op">;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>module<span class="op">.</span><span class="at">exports</span> <span class="op">=</span> router<span class="op">;</span></span></code></pre></div>
<p>Finally, we can add our router to the <code>app.js</code> file that
contains all the overall router connections.</p>
<h5
id="app.js---the-main-function-for-the-server-located-in-the-directory-src">app.js
- The main function for the server, located in the directory ‘src’</h5>
<div class="sourceCode" id="cb11"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">...</span> <span class="co">// </span><span class="al">NOTE</span><span class="co">: you&#39;ll likely need more import statements, with this example showing the routing of models</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> express <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;express&#39;</span>)<span class="op">;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> sessions <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;express-session&#39;</span>)<span class="op">;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> bodyParser <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;body-parser&#39;</span>)<span class="op">;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> testingRouter <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;./testing&#39;</span>)<span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> server <span class="op">=</span> <span class="fu">express</span>()<span class="op">;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>server<span class="op">.</span><span class="fu">use</span>(bodyParser<span class="op">.</span><span class="fu">urlencoded</span>({ <span class="dt">extended</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>server<span class="op">.</span><span class="fu">use</span>(bodyParser<span class="op">.</span><span class="fu">json</span>())<span class="op">;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// After Database initialization, in follow-up function</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    server<span class="op">.</span><span class="fu">use</span>(<span class="st">&#39;/testing&#39;</span><span class="op">,</span> testingRouter)<span class="op">;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span></code></pre></div>
<p>Assuming that all other, relavant, import statements are included,
the ExpressJS server should now work, congrats! However, this leads us
with the next major step of the project; the client…</p>
<hr />
<p>For the client, we’re going to assume that you’ve created a project
that incorporates a folder for the page you want to include the database
query for. In this example, we’ll use the page titled “Test Page”, which
will be located in the folder ‘src/test_page’ in the client.</p>
<blockquote>
<p>To get us started, as a reminder, this verion of the project will be
utilizing Axios, a NodeJS package designed to help with requests and
responces between a client and a server, except it’s a bit easier to add
in parameters for the request. This will be referenced as the project
continues.</p>
</blockquote>
<p>For this project, the Axios instance is located in the directory
‘src/apiAdapter’ within the client. This directory consists of a main
<code>index.js</code> file, an <code>axios_instance.js</code> file,
along with an adapter file for each specific page. These adapter files
for the client are similar to the controller file on the server, where
only one can exist for a page or set of pages, with the controller
contributing to several requests; the main difference between each
controller is the start of the request URL.</p>
<h5
id="axios_instance.js---located-on-the-client-at-srcapiadapter">axios_instance.js
- Located on the client at ‘src/apiAdapter’</h5>
<div class="sourceCode" id="cb12"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> axios <span class="im">from</span> <span class="st">&#39;axios&#39;</span><span class="op">;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> instance <span class="op">=</span> axios<span class="op">.</span><span class="fu">create</span>({</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">baseURL</span><span class="op">:</span> <span class="st">&#39;http://localhost:3001&#39;</span><span class="op">,</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">withCredentials</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="co">// Optional setting, based on how secure you want your request system. </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                        <span class="co">// Possible to effect the server files.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="im">default</span> instance<span class="op">;</span></span></code></pre></div>
<h5
id="testing.adapter.js---located-on-the-client-at-srcapiadapter">testing.adapter.js
- Located on the client at ‘src/apiAdapter’</h5>
<div class="sourceCode" id="cb13"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> axiosInstance <span class="im">from</span> <span class="st">&#39;api_adapter/axios_instance&#39;</span><span class="op">;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="kw">const</span> someDatabaseModelFunction <span class="op">=</span> <span class="kw">async</span> (request) <span class="kw">=&gt;</span> {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Can add other functions to clean up between request input and response.</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Use the URL of the GET/POST request you are using on the server</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> responce <span class="op">=</span> <span class="cf">await</span> axiosInstance<span class="op">.</span><span class="fu">post</span>(<span class="st">&#39;/testing/testingPost&#39;</span><span class="op">,</span> {request})<span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> response<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h5 id="index.js---located-on-the-client-at-srcapiadapter">index.js -
Located on the client at ‘src/apiAdapter’</h5>
<div class="sourceCode" id="cb14"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> testingAdapter <span class="im">from</span> <span class="st">&#39;apiAdapter/testing.adapter&#39;</span><span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> apiAdapter <span class="op">=</span> {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>testingAdapter<span class="op">,</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="im">default</span> apiAdapter<span class="op">;</span></span></code></pre></div>
<p>These componets of code will at least get our <code>apiAdapter</code>
functional to use on the client. We can now create the controller for
the site. We’re going to create the following file in the
‘src/test_page/controller’ directory.</p>
<blockquote>
<p><strong>NOTE:</strong> This single controller file can contain
several apiAdapter functions as well.</p>
</blockquote>
<h5
id="test_page.controller.js---located-on-the-client-at-srctest_pagecontroller">test_page.controller.js
- Located on the client at ‘src/test_page/controller’</h5>
<div class="sourceCode" id="cb15"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> apiAdapter <span class="im">from</span> <span class="st">&quot;apiAdapter&quot;</span><span class="op">;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> someDatabaseModelFunction <span class="op">=</span> <span class="kw">async</span> (dataValue1<span class="op">,</span> dataValue2<span class="op">,</span> dataValue3) <span class="kw">=&gt;</span> {</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> response <span class="op">=</span> <span class="cf">await</span> apiAdapter<span class="op">.</span><span class="fu">someDatabaseModelFunction</span>({</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">// You can format your data however you best see fit</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">data</span><span class="op">:</span> {</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">val1</span><span class="op">:</span> dataValue1<span class="op">,</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>            <span class="dt">val2</span><span class="op">:</span> dataValue2<span class="op">,</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">val3</span><span class="op">:</span> dataValue3<span class="op">,</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> response<span class="op">;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> testPageController <span class="op">=</span> {</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    someDatabaseModelFunction<span class="op">,</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="im">default</span> testPageController<span class="op">;</span></span></code></pre></div>
<p>We’ve just created our controller that we can now use to get data
from the database into the server from the client! Now, let’s go on the
page itself, and do it!</p>
<h5
id="index.jsx---example-page-located-in-client-at-srctest_page">index.jsx
- Example page, located in client at ‘src/test_page’</h5>
<div class="sourceCode" id="cb16"><pre
class="sourceCode js"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> React<span class="op">,</span> {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    ReactElement<span class="op">,</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    useEffect<span class="op">,</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    useState<span class="op">,</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    useRef<span class="op">,</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>} <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {testPageController} <span class="im">from</span> <span class="st">&#39;./controller&#39;</span><span class="op">;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="fu">TestPage</span>() {</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// You can utilize the call in most places on the page, based on the prereqs.</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> getData <span class="op">=</span> <span class="kw">async</span>(v1<span class="op">,</span> v2<span class="op">,</span> v3) <span class="kw">=&gt;</span> {</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> request <span class="op">=</span> <span class="cf">await</span> testPageController<span class="op">.</span><span class="fu">someDatabaseModelFunction</span>(v1<span class="op">,</span> v2<span class="op">,</span> v3)<span class="op">;</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dataResponse <span class="op">=</span> request<span class="op">.</span><span class="at">data</span><span class="op">.</span><span class="at">data</span> <span class="co">// Exact path will likely be different</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                                                <span class="co">// Implementation based</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Do something with the data</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<blockquote>
<p><strong>FUNFACT:</strong> You may have noticed that we used the same
function name several times in this project,
<code>someDatabaseModelFunction</code>. This is <strong>NOT</strong>
required. This can make it easier to ensure that in each layer the
correct function is being called, but this can change to make it more
unique to the overall project.</p>
</blockquote>
<hr />
<p><a name="conclude"></a></p>
<h2 id="conclusion">Conclusion</h2>
<p>This has been an example on how to add a level of abstraction to a
client-server website for database access, but this isn’t the only way
to do this. Several people have worked on various methodologies to add a
form of middleware (<a
href="https://gtsopour.medium.com/nodejs-express-middleware-abstraction-2d25926516e4">example
by Medium</a>) or add other forms of abstraction. Feel free to
experiement with ReactJS and ExpressJS to make the client and server
that work best for your project.</p>
<p>The main thing to worry about after the development of your system,
is to make is maintainable and teachable enough to allow for future
developers and webmasters to take your place!</p>
<p>Happy Coding!</p>
<hr />
<p>© George D. Crochiere</p>
</body>
</html>
